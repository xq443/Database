"0","extract_query <- """
"0","  SELECT "
"0","    r.rental_id,"
"0","    DATE(r.rental_date) AS date_id,"
"0","    r.customer_id,"
"0","    r.staff_id,"
"0","    i.store_id,"
"0","    IFNULL(SUM(p.amount), 0) AS rental_amount,"
"0","    CAST((JULIANDAY(r.return_date) - JULIANDAY(r.rental_date)) AS INTEGER) AS late_return_days"
"0","  FROM rental r"
"0","  JOIN inventory i ON r.inventory_id = i.inventory_id"
"0","  LEFT JOIN payment p ON r.rental_id = p.rental_id"
"0","  GROUP BY r.rental_id"
"0",""""
"0",""
"0","rental_facts <- dbGetQuery(sakila_conn, extract_query)"
"0","head(rental_facts)"
