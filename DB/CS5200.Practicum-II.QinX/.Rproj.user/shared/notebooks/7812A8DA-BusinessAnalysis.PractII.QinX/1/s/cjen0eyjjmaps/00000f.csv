"0","# Get total revenue per year"
"0","yearly_revenue <- dbGetQuery(con, """
"0","  SELECT YEAR(date) AS year, ROUND(SUM(revenue), 0) AS total_revenue"
"0","  FROM fact_sales"
"0","  GROUP BY year"
"0","  ORDER BY total_revenue DESC;"
"0",""")"
"0",""
"0","# Get the top revenue year and value"
"0","top_year <- yearly_revenue$year[1]"
"0","top_revenue <- formatC(yearly_revenue$total_revenue[1], format = ""d"", big.mark = "","")"
"0",""
"0","# Get revenue by country/year"
"0","country_year_revenue <- dbGetQuery(con, """
"0","  SELECT country, YEAR(date) AS year, ROUND(SUM(revenue), 0) AS revenue"
"0","  FROM fact_sales"
"0","  GROUP BY country, year"
"0","  ORDER BY revenue DESC;"
"0",""")"
"0",""
"0","# Most revenue by country/year"
"0","top_country_row <- country_year_revenue[1, ]"
"0","top_country <- top_country_row$country"
"0","top_country_year <- top_country_row$year"
"0","top_country_revenue <- formatC(top_country_row$revenue, format = ""d"", big.mark = "","")"
"0",""
"0","# Second place country"
"0","second_country_row <- country_year_revenue[2, ]"
"0","second_country <- second_country_row$country"
"0","second_country_revenue <- formatC(second_country_row$revenue, format = ""d"", big.mark = "","")"
"0",""
"0","# Extract two most recent years from fact_sales"
"0","most_recent_years <- dbGetQuery(con, """
"0","  SELECT DISTINCT YEAR(date) AS year"
"0","  FROM fact_sales"
"0","  ORDER BY year DESC"
"0","  LIMIT 2;"
"0",""")"
"0",""
"0","# Extract and assign years"
"0","year1 <- most_recent_years$year[1]"
"0","year2 <- most_recent_years$year[2]"
"0",""
"0",""
