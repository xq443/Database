"0","# Drop any user-defined indexes (ignore errors if they don't exist)"
"0","# First, list all indexes in the DB and drop those not part of the system"
"0","indexes <- dbGetQuery(conn, """
"0","  SELECT name "
"0","  FROM sqlite_master "
"0","  WHERE type = 'index' "
"0","    AND sql IS NOT NULL;"
"0",""")"
"0",""
"0","for (index_name in indexes$name) {"
"0","  drop_sql <- sprintf(""DROP INDEX IF EXISTS [%s];"", index_name)"
"0","  dbExecute(conn, drop_sql)"
"0","}"
"0",""
"0","# Run query to get number of films per language"
"0","query <- """
"0","  SELECT l.name AS language, COUNT(f.film_id) AS film_count"
"0","  FROM film f"
"0","  JOIN language l ON f.language_id = l.language_id"
"0","  GROUP BY l.name;"
"0",""""
"0",""
"0","result <- dbGetQuery(conn, query)"
"0","print(result)"
